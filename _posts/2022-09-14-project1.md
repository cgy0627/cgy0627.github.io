---
layout : single
title : Project1 - 코로나가 관광산업에 미치는 영향
tags : Python, Project
---

# 🧐 개요

코로나가 관광산업에 어떤 영향을 미쳤는지 알아보기 위해 공공데이터포털(https://www.data.go.kr/) 에서 얻은 코로나 확진자수 및 사망자수를 포함한 데이터와 한국관광데이터랩(https://datalab.visitkorea.or.kr/) 에서 불러온 월별 관광자수 데이터를 이용하였습니다.

# 🔨 데이터 불러오기 및 전처리

## 🔧 코로나 데이터 전처리

데이터 전처리에 필요한 라이브러리를 불러왔습니다.


```python
import pandas as pd
import numpy as np
import requests
import xmltodict
```

📁 공공데이터포털에서 승인 된 데이터를 불러왔습니다. 기간은 2020.1.20 ~ 2022.6.30 사이의 데이터를 이용하였습니다.


```python
url = 'http://openapi.data.go.kr/openapi/service/rest/Covid19/getCovid19SidoInfStateJson'
params ={'serviceKey' : 'rnF4yyGFp4RmLHiQ/PXaEmoqBuiQ0mv72GW7vb0hxrgRZqSk/zHAJN0QO5hP79QMhoXZTOwY8fh2cl7BSynbxg==', 
         'pageNo' : '1', 
         'numOfRows' : '10', 
         'startCreateDt' : '20200120', 
         'endCreateDt' : '20220630' }

response = requests.get(url, params=params)
```

xml 형태로 불러온 데이터를 딕셔너리 형태로 바꿔서 parsing을 진행하고 **covidData** 데이터프레임으로 저장하였습니다.


```python
result = xmltodict.parse(response.text)
```


```python
covidData = pd.DataFrame(result['response']['body']['items']['item'])
covidData
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>createDt</th>
      <th>deathCnt</th>
      <th>defCnt</th>
      <th>gubun</th>
      <th>gubunCn</th>
      <th>gubunEn</th>
      <th>incDec</th>
      <th>localOccCnt</th>
      <th>overFlowCnt</th>
      <th>qurRate</th>
      <th>seq</th>
      <th>stdDay</th>
      <th>updateDt</th>
      <th>isolClearCnt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022-06-30 09:01:32.277</td>
      <td>16</td>
      <td>11308</td>
      <td>검역</td>
      <td>隔離區</td>
      <td>Lazaretto</td>
      <td>9</td>
      <td>0</td>
      <td>9</td>
      <td>-</td>
      <td>17850</td>
      <td>2022년 06월 30일 00시</td>
      <td>null</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-06-30 09:01:32.277</td>
      <td>182</td>
      <td>239066</td>
      <td>제주</td>
      <td>济州</td>
      <td>Jeju</td>
      <td>205</td>
      <td>181</td>
      <td>24</td>
      <td>35325</td>
      <td>17849</td>
      <td>2022년 06월 30일 00시</td>
      <td>null</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022-06-30 09:01:32.276</td>
      <td>1259</td>
      <td>1103742</td>
      <td>경남</td>
      <td>庆南</td>
      <td>Gyeongsangnam-do</td>
      <td>560</td>
      <td>547</td>
      <td>13</td>
      <td>33304</td>
      <td>17848</td>
      <td>2022년 06월 30일 00시</td>
      <td>null</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2022-06-30 09:01:32.276</td>
      <td>1408</td>
      <td>792074</td>
      <td>경북</td>
      <td>庆北</td>
      <td>Gyeongsangbuk-do</td>
      <td>501</td>
      <td>492</td>
      <td>9</td>
      <td>30156</td>
      <td>17847</td>
      <td>2022년 06월 30일 00시</td>
      <td>null</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2022-06-30 09:01:32.275</td>
      <td>483</td>
      <td>602118</td>
      <td>전남</td>
      <td>全南</td>
      <td>Jeollanam-do</td>
      <td>250</td>
      <td>247</td>
      <td>3</td>
      <td>32852</td>
      <td>17846</td>
      <td>2022년 06월 30일 00시</td>
      <td>null</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>16962</th>
      <td>2020-01-20 09:00:00.000</td>
      <td>0</td>
      <td>0</td>
      <td>전남</td>
      <td>全南</td>
      <td>Jeollanam-do</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.00</td>
      <td>5</td>
      <td>2020년 01월 20일 00시</td>
      <td>2021-09-16 10:11:33.897</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16963</th>
      <td>2020-01-20 09:00:00.000</td>
      <td>0</td>
      <td>0</td>
      <td>경북</td>
      <td>庆北</td>
      <td>Gyeongsangbuk-do</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.00</td>
      <td>4</td>
      <td>2020년 01월 20일 00시</td>
      <td>2021-09-16 10:11:33.897</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16964</th>
      <td>2020-01-20 09:00:00.000</td>
      <td>0</td>
      <td>0</td>
      <td>경남</td>
      <td>庆南</td>
      <td>Gyeongsangnam-do</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.00</td>
      <td>3</td>
      <td>2020년 01월 20일 00시</td>
      <td>2021-09-16 10:11:33.897</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16965</th>
      <td>2020-01-20 09:00:00.000</td>
      <td>0</td>
      <td>0</td>
      <td>제주</td>
      <td>济州</td>
      <td>Jeju</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.00</td>
      <td>2</td>
      <td>2020년 01월 20일 00시</td>
      <td>2021-09-16 10:11:33.897</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16966</th>
      <td>2020-01-20 09:00:00.000</td>
      <td>0</td>
      <td>0</td>
      <td>검역</td>
      <td>隔離區</td>
      <td>Lazaretto</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.00</td>
      <td>1</td>
      <td>2020년 01월 20일 00시</td>
      <td>2021-09-16 10:11:33.897</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>16967 rows × 14 columns</p>
</div>



시각화에 필요한 ***날짜, 지역, 누적사망자수, 누적확진자수*** 데이터만 가져와줍니다.


```python
covidData1 = covidData[['createDt', 'gubun', 'deathCnt', 'defCnt']]
covidData1.columns = ['날짜', '지역', '누적사망자수', '누적확진자수']
```

월별 전체 확진자수와 사망자수를 구하기 위해 지역명이 **'합계'**인 데이터만 이용하였습니다.


```python
covidData2 = covidData1[covidData1['지역'] == '합계']
covidData2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>지역</th>
      <th>누적사망자수</th>
      <th>누적확진자수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>18</th>
      <td>2022-06-30 09:01:32.268</td>
      <td>합계</td>
      <td>24547</td>
      <td>18359341</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2022-06-29 09:13:21.181</td>
      <td>합계</td>
      <td>24537</td>
      <td>18349756</td>
    </tr>
    <tr>
      <th>56</th>
      <td>2022-06-28 08:52:54.486</td>
      <td>합계</td>
      <td>24530</td>
      <td>18339319</td>
    </tr>
    <tr>
      <th>75</th>
      <td>2022-06-27 09:12:17.185</td>
      <td>합계</td>
      <td>24525</td>
      <td>18329448</td>
    </tr>
    <tr>
      <th>94</th>
      <td>2022-06-26 09:35:56.853</td>
      <td>합계</td>
      <td>24522</td>
      <td>18326019</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>16872</th>
      <td>2020-01-24 09:00:00.000</td>
      <td>합계</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>16891</th>
      <td>2020-01-23 09:00:00.000</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16910</th>
      <td>2020-01-22 09:00:00.000</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16929</th>
      <td>2020-01-21 09:00:00.000</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16948</th>
      <td>2020-01-20 09:00:00.000</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>893 rows × 4 columns</p>
</div>



📆 날짜 변수에서 ⌚시간을 제거하였습니다.


```python
covidData2['날짜'] = covidData2['날짜'].apply(lambda x: x.split(' ')[0])
covidData2
```

    C:\Users\USER\AppData\Local\Temp/ipykernel_18532/700311428.py:1: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      covidData2['날짜'] = covidData2['날짜'].apply(lambda x: x.split(' ')[0])
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>지역</th>
      <th>누적사망자수</th>
      <th>누적확진자수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>18</th>
      <td>2022-06-30</td>
      <td>합계</td>
      <td>24547</td>
      <td>18359341</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2022-06-29</td>
      <td>합계</td>
      <td>24537</td>
      <td>18349756</td>
    </tr>
    <tr>
      <th>56</th>
      <td>2022-06-28</td>
      <td>합계</td>
      <td>24530</td>
      <td>18339319</td>
    </tr>
    <tr>
      <th>75</th>
      <td>2022-06-27</td>
      <td>합계</td>
      <td>24525</td>
      <td>18329448</td>
    </tr>
    <tr>
      <th>94</th>
      <td>2022-06-26</td>
      <td>합계</td>
      <td>24522</td>
      <td>18326019</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>16872</th>
      <td>2020-01-24</td>
      <td>합계</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>16891</th>
      <td>2020-01-23</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16910</th>
      <td>2020-01-22</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16929</th>
      <td>2020-01-21</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>16948</th>
      <td>2020-01-20</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>893 rows × 4 columns</p>
</div>



가져온 데이터는 누적 사망자 수, 누적 확진자 수를 가지고 있는 데이터이므로 일자별로 차이를 구해 ***일별 확진자 수, 일별 사망자 수*** 라는 새로운 변수를 만들었습니다.

우선, 📆 날짜 순서대로 정렬하고 reset_index()로 인덱스를 재설정 해주었습니다.


```python
covidData2.sort_values('날짜', inplace = True)
covidData2.reset_index(drop = True, inplace = True)
covidData2
```

    C:\Users\USER\anaconda3\lib\site-packages\pandas\util\_decorators.py:311: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      return func(*args, **kwargs)
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>지역</th>
      <th>누적사망자수</th>
      <th>누적확진자수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-20</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-21</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-22</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-23</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-24</td>
      <td>합계</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>888</th>
      <td>2022-06-26</td>
      <td>합계</td>
      <td>24522</td>
      <td>18326019</td>
    </tr>
    <tr>
      <th>889</th>
      <td>2022-06-27</td>
      <td>합계</td>
      <td>24525</td>
      <td>18329448</td>
    </tr>
    <tr>
      <th>890</th>
      <td>2022-06-28</td>
      <td>합계</td>
      <td>24530</td>
      <td>18339319</td>
    </tr>
    <tr>
      <th>891</th>
      <td>2022-06-29</td>
      <td>합계</td>
      <td>24537</td>
      <td>18349756</td>
    </tr>
    <tr>
      <th>892</th>
      <td>2022-06-30</td>
      <td>합계</td>
      <td>24547</td>
      <td>18359341</td>
    </tr>
  </tbody>
</table>
<p>893 rows × 4 columns</p>
</div>



날짜로 정렬된 데이터로 **일별 확진자 수**를 계산하고...


```python
defCnt = [int(covidData2['누적확진자수'][i+1]) - int(covidData2['누적확진자수'][i]) for i in range(len(covidData2)-1)]
defCnt[0] = covidData2['누적확진자수'][0]

len(defCnt)
```




    892



**일별 사망자 수**를 계산하였습니다. ✨


```python
deathCnt = [int(covidData2['누적사망자수'][i+1]) - int(covidData2['누적사망자수'][i]) for i in range(len(covidData2)-1)]
deathCnt[0] = covidData2['누적사망자수'][0]

len(deathCnt)
```




    892



✔ 네이버 코로나 확진자 수랑 비교해보니까 하루씩 차이가 나서 집계방식에 차이가 있는 것 같아서 **네이버 기준**으로 맞췄습니다!


```python
#6월 30일 확진자, 사망자 데이터 추가
defCnt.append(9548)
deathCnt.append(8)
```


```python
#일별 칼럼 데이터프레임에 추가
covidData3 = covidData2.copy()

covidData3['일별확진자수'] = defCnt
covidData3['일별사망자수'] = deathCnt

#사망자수, 확진자수 데이터 숫자로 변환
covidData3['일별사망자수'] = covidData3['일별사망자수'].astype(int)
covidData3['일별확진자수'] = covidData3['일별확진자수'].astype(int)

covidData3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>지역</th>
      <th>누적사망자수</th>
      <th>누적확진자수</th>
      <th>일별확진자수</th>
      <th>일별사망자수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-20</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-21</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-22</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-23</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-24</td>
      <td>합계</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>888</th>
      <td>2022-06-26</td>
      <td>합계</td>
      <td>24522</td>
      <td>18326019</td>
      <td>3429</td>
      <td>3</td>
    </tr>
    <tr>
      <th>889</th>
      <td>2022-06-27</td>
      <td>합계</td>
      <td>24525</td>
      <td>18329448</td>
      <td>9871</td>
      <td>5</td>
    </tr>
    <tr>
      <th>890</th>
      <td>2022-06-28</td>
      <td>합계</td>
      <td>24530</td>
      <td>18339319</td>
      <td>10437</td>
      <td>7</td>
    </tr>
    <tr>
      <th>891</th>
      <td>2022-06-29</td>
      <td>합계</td>
      <td>24537</td>
      <td>18349756</td>
      <td>9585</td>
      <td>10</td>
    </tr>
    <tr>
      <th>892</th>
      <td>2022-06-30</td>
      <td>합계</td>
      <td>24547</td>
      <td>18359341</td>
      <td>9548</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
<p>893 rows × 6 columns</p>
</div>



월별로 확진자 수와 사망자 수를 합치기 위해 날짜를 년도와 월로 나누어 진행하였습니다.


```python
#년도 데이터 생성
covidData4 = covidData3.copy()
covidData4['년도'] = covidData3['날짜'].apply(lambda x: x.split('-')[0])

#월 데이터 생성
covidData4['월'] = covidData3['날짜'].apply(lambda x: x.split('-')[1])
covidData4
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>날짜</th>
      <th>지역</th>
      <th>누적사망자수</th>
      <th>누적확진자수</th>
      <th>일별확진자수</th>
      <th>일별사망자수</th>
      <th>년도</th>
      <th>월</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-20</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2020</td>
      <td>01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-21</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2020</td>
      <td>01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-22</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2020</td>
      <td>01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-23</td>
      <td>합계</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2020</td>
      <td>01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-24</td>
      <td>합계</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2020</td>
      <td>01</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>888</th>
      <td>2022-06-26</td>
      <td>합계</td>
      <td>24522</td>
      <td>18326019</td>
      <td>3429</td>
      <td>3</td>
      <td>2022</td>
      <td>06</td>
    </tr>
    <tr>
      <th>889</th>
      <td>2022-06-27</td>
      <td>합계</td>
      <td>24525</td>
      <td>18329448</td>
      <td>9871</td>
      <td>5</td>
      <td>2022</td>
      <td>06</td>
    </tr>
    <tr>
      <th>890</th>
      <td>2022-06-28</td>
      <td>합계</td>
      <td>24530</td>
      <td>18339319</td>
      <td>10437</td>
      <td>7</td>
      <td>2022</td>
      <td>06</td>
    </tr>
    <tr>
      <th>891</th>
      <td>2022-06-29</td>
      <td>합계</td>
      <td>24537</td>
      <td>18349756</td>
      <td>9585</td>
      <td>10</td>
      <td>2022</td>
      <td>06</td>
    </tr>
    <tr>
      <th>892</th>
      <td>2022-06-30</td>
      <td>합계</td>
      <td>24547</td>
      <td>18359341</td>
      <td>9548</td>
      <td>8</td>
      <td>2022</td>
      <td>06</td>
    </tr>
  </tbody>
</table>
<p>893 rows × 8 columns</p>
</div>




```python
#월별로 확진자수와 사망자수 합치기
covidData5 = covidData4.groupby(['년도', '월'])[['일별사망자수', '일별확진자수']].sum()

#칼럼 이름을 설정하고 인덱스 재설정해주기
covidData5.columns = ['월별사망자수', '월별확진자수']
covidData5.reset_index(inplace = True)

covidData5
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>년도</th>
      <th>월</th>
      <th>월별사망자수</th>
      <th>월별확진자수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020</td>
      <td>01</td>
      <td>0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020</td>
      <td>02</td>
      <td>17</td>
      <td>3514</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020</td>
      <td>03</td>
      <td>148</td>
      <td>6361</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020</td>
      <td>04</td>
      <td>83</td>
      <td>887</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020</td>
      <td>05</td>
      <td>23</td>
      <td>729</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020</td>
      <td>06</td>
      <td>11</td>
      <td>1347</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2020</td>
      <td>07</td>
      <td>19</td>
      <td>1486</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2020</td>
      <td>08</td>
      <td>23</td>
      <td>5845</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2020</td>
      <td>09</td>
      <td>91</td>
      <td>3707</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2020</td>
      <td>10</td>
      <td>51</td>
      <td>2747</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2020</td>
      <td>11</td>
      <td>60</td>
      <td>8015</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2020</td>
      <td>12</td>
      <td>391</td>
      <td>27103</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2021</td>
      <td>01</td>
      <td>508</td>
      <td>16749</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2021</td>
      <td>02</td>
      <td>180</td>
      <td>11517</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2021</td>
      <td>03</td>
      <td>130</td>
      <td>13611</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2021</td>
      <td>04</td>
      <td>96</td>
      <td>19003</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2021</td>
      <td>05</td>
      <td>132</td>
      <td>18163</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2021</td>
      <td>06</td>
      <td>58</td>
      <td>16925</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2021</td>
      <td>07</td>
      <td>77</td>
      <td>42055</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2021</td>
      <td>08</td>
      <td>194</td>
      <td>53663</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2021</td>
      <td>09</td>
      <td>205</td>
      <td>60328</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2021</td>
      <td>10</td>
      <td>361</td>
      <td>52619</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2021</td>
      <td>11</td>
      <td>801</td>
      <td>85964</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2021</td>
      <td>12</td>
      <td>1966</td>
      <td>182903</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2022</td>
      <td>01</td>
      <td>1147</td>
      <td>228789</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2022</td>
      <td>02</td>
      <td>1398</td>
      <td>2409407</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2022</td>
      <td>03</td>
      <td>8420</td>
      <td>10102369</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2022</td>
      <td>04</td>
      <td>6285</td>
      <td>3899831</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2022</td>
      <td>05</td>
      <td>1322</td>
      <td>843766</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2022</td>
      <td>06</td>
      <td>358</td>
      <td>249474</td>
    </tr>
  </tbody>
</table>
</div>



2020년 1월 이전에는 코로나가 존재하지 않았기 때문에 데이터가 없지만 
관광데이터와 병합하기 위해서 임의로 행을 만들어 주었습니다.


```python
covidData5.loc[30] = ['2019', '07', 0, 0]
covidData5.loc[31] = ['2019', '08', 0, 0]
covidData5.loc[32] = ['2019', '09', 0, 0]
covidData5.loc[33] = ['2019', '10', 0, 0]
covidData5.loc[34] = ['2019', '11', 0, 0]
covidData5.loc[35] = ['2019', '12', 0, 0]
```


```python
covidData5 = covidData5.sort_values(['년도','월'])
covidData5.reset_index(inplace=True)
covidData5.drop(['index'], axis=1, inplace=True)

covidData5
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>년도</th>
      <th>월</th>
      <th>월별사망자수</th>
      <th>월별확진자수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019</td>
      <td>07</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019</td>
      <td>08</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019</td>
      <td>09</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019</td>
      <td>11</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2019</td>
      <td>12</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2020</td>
      <td>01</td>
      <td>0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2020</td>
      <td>02</td>
      <td>17</td>
      <td>3514</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2020</td>
      <td>03</td>
      <td>148</td>
      <td>6361</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2020</td>
      <td>04</td>
      <td>83</td>
      <td>887</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2020</td>
      <td>05</td>
      <td>23</td>
      <td>729</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2020</td>
      <td>06</td>
      <td>11</td>
      <td>1347</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2020</td>
      <td>07</td>
      <td>19</td>
      <td>1486</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2020</td>
      <td>08</td>
      <td>23</td>
      <td>5845</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2020</td>
      <td>09</td>
      <td>91</td>
      <td>3707</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2020</td>
      <td>10</td>
      <td>51</td>
      <td>2747</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2020</td>
      <td>11</td>
      <td>60</td>
      <td>8015</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2020</td>
      <td>12</td>
      <td>391</td>
      <td>27103</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2021</td>
      <td>01</td>
      <td>508</td>
      <td>16749</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2021</td>
      <td>02</td>
      <td>180</td>
      <td>11517</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2021</td>
      <td>03</td>
      <td>130</td>
      <td>13611</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2021</td>
      <td>04</td>
      <td>96</td>
      <td>19003</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2021</td>
      <td>05</td>
      <td>132</td>
      <td>18163</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2021</td>
      <td>06</td>
      <td>58</td>
      <td>16925</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2021</td>
      <td>07</td>
      <td>77</td>
      <td>42055</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2021</td>
      <td>08</td>
      <td>194</td>
      <td>53663</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2021</td>
      <td>09</td>
      <td>205</td>
      <td>60328</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2021</td>
      <td>10</td>
      <td>361</td>
      <td>52619</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2021</td>
      <td>11</td>
      <td>801</td>
      <td>85964</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2021</td>
      <td>12</td>
      <td>1966</td>
      <td>182903</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2022</td>
      <td>01</td>
      <td>1147</td>
      <td>228789</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2022</td>
      <td>02</td>
      <td>1398</td>
      <td>2409407</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2022</td>
      <td>03</td>
      <td>8420</td>
      <td>10102369</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2022</td>
      <td>04</td>
      <td>6285</td>
      <td>3899831</td>
    </tr>
    <tr>
      <th>34</th>
      <td>2022</td>
      <td>05</td>
      <td>1322</td>
      <td>843766</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2022</td>
      <td>06</td>
      <td>358</td>
      <td>249474</td>
    </tr>
  </tbody>
</table>
</div>



💾 전처리가 완성된 데이터를 CSV 파일로 저장합니다.


```python
covidData5.to_csv('covidData_final.csv', encoding = 'euc-kr')
```

## 🔧 관광 데이터 전처리

📂 한국관광데이터랩(https://datalab.visitkorea.or.kr/datalab/portal/main/getMainForm.do) 사이트에서 2019년 07월부터 2022년 06월까지의 데이터를 다운받았습니다.

CSV 파일에 저장된 데이터를 불러와 **tour_df** 데이터프레임에 저장하였습니다.


```python
tour_df = pd.read_csv("./관광데이타_최종.csv", encoding='cp949')
tour_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>년월</th>
      <th>시도명</th>
      <th>방문자수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-07</td>
      <td>서울특별시</td>
      <td>60400000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-07</td>
      <td>부산광역시</td>
      <td>13600000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-07</td>
      <td>대구광역시</td>
      <td>9655894.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-07</td>
      <td>인천광역시</td>
      <td>16300000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-07</td>
      <td>광주광역시</td>
      <td>5843693.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>607</th>
      <td>2022-06</td>
      <td>전라북도</td>
      <td>7855493.0</td>
    </tr>
    <tr>
      <th>608</th>
      <td>2022-06</td>
      <td>전라남도</td>
      <td>10300000.0</td>
    </tr>
    <tr>
      <th>609</th>
      <td>2022-06</td>
      <td>경상북도</td>
      <td>14500000.0</td>
    </tr>
    <tr>
      <th>610</th>
      <td>2022-06</td>
      <td>경상남도</td>
      <td>11900000.0</td>
    </tr>
    <tr>
      <th>611</th>
      <td>2022-06</td>
      <td>제주특별자치도</td>
      <td>5873436.0</td>
    </tr>
  </tbody>
</table>
<p>612 rows × 3 columns</p>
</div>



월별 방문자 수의 합을 구합니다.


```python
tour_sum = [tour_df['방문자수'][i:i+16].sum() for i in range(0,612,17)]
tour_sum
```




    [262952388.0,
     293357382.0,
     271154784.0,
     254882209.0,
     254841999.0,
     235297924.0,
     241488710.0,
     176791577.0,
     174545220.0,
     182713809.0,
     218194401.0,
     199010094.0,
     220232761.0,
     218711070.0,
     194305025.0,
     231321706.0,
     199680061.0,
     173035276.0,
     167850335.0,
     186986626.0,
     219365480.0,
     190822478.0,
     212421829.0,
     198152108.0,
     205164658.0,
     209056719.0,
     223985527.0,
     224882734.0,
     211169326.0,
     202761767.0,
     211720699.0,
     211720699.0,
     211720699.0,
     211720699.0,
     211720699.0,
     223515196.0]



2019년 7월부터 2022년 6월까지의 날짜를 구합니다.


```python
tour_month = []
for i in range(2019,2023):
  for j in range(1,13):
    if (i==2019 and j>6) or (i==2020) or (i==2021) or(i==2022 and j<7):
      tour_month.append(f'{i}-{j}')     
tour_month
```




    ['2019-7',
     '2019-8',
     '2019-9',
     '2019-10',
     '2019-11',
     '2019-12',
     '2020-1',
     '2020-2',
     '2020-3',
     '2020-4',
     '2020-5',
     '2020-6',
     '2020-7',
     '2020-8',
     '2020-9',
     '2020-10',
     '2020-11',
     '2020-12',
     '2021-1',
     '2021-2',
     '2021-3',
     '2021-4',
     '2021-5',
     '2021-6',
     '2021-7',
     '2021-8',
     '2021-9',
     '2021-10',
     '2021-11',
     '2021-12',
     '2022-1',
     '2022-2',
     '2022-3',
     '2022-4',
     '2022-5',
     '2022-6']



년월별로 방문자 수의 합계를 새로운 **tour_data** 데이터프레임에 저장합니다.


```python
tour_data=pd.DataFrame(tour_month)
tour_data['총 방문자수']=tour_sum
tour_data.columns = ['년월', '방문자수']
tour_data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>년월</th>
      <th>방문자수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-7</td>
      <td>262952388.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-8</td>
      <td>293357382.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-9</td>
      <td>271154784.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-10</td>
      <td>254882209.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-11</td>
      <td>254841999.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2019-12</td>
      <td>235297924.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2020-1</td>
      <td>241488710.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2020-2</td>
      <td>176791577.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2020-3</td>
      <td>174545220.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2020-4</td>
      <td>182713809.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2020-5</td>
      <td>218194401.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2020-6</td>
      <td>199010094.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2020-7</td>
      <td>220232761.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2020-8</td>
      <td>218711070.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2020-9</td>
      <td>194305025.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2020-10</td>
      <td>231321706.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2020-11</td>
      <td>199680061.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2020-12</td>
      <td>173035276.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2021-1</td>
      <td>167850335.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2021-2</td>
      <td>186986626.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2021-3</td>
      <td>219365480.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2021-4</td>
      <td>190822478.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2021-5</td>
      <td>212421829.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2021-6</td>
      <td>198152108.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2021-7</td>
      <td>205164658.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2021-8</td>
      <td>209056719.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2021-9</td>
      <td>223985527.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2021-10</td>
      <td>224882734.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2021-11</td>
      <td>211169326.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2021-12</td>
      <td>202761767.0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2022-1</td>
      <td>211720699.0</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2022-2</td>
      <td>211720699.0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2022-3</td>
      <td>211720699.0</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2022-4</td>
      <td>211720699.0</td>
    </tr>
    <tr>
      <th>34</th>
      <td>2022-5</td>
      <td>211720699.0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2022-6</td>
      <td>223515196.0</td>
    </tr>
  </tbody>
</table>
</div>



💾 전처리가 완성된 데이터를 CSV 파일로 저장합니다.


```python
tour_data.to_csv('tourData_final.csv', encoding = 'euc-kr')
```

# 📊 데이터 시각화

코랩에서 한글 폰트 깨지는 현상 해결을 위해 한국어 폰트들을 설치합니다


```python
import matplotlib
import matplotlib.pyplot as plt
from matplotlib import rc
import matplotlib.font_manager as fm

print([f.name for f in matplotlib.font_manager.fontManager.ttflist if 'Malgun' in f.name])

# 한글 폰트 설정
plt.rc('font', family='Malgun Gothic') 
# - 기호 깨짐 현상 방지를 위한 설정
plt.rc('axes', unicode_minus=False)
```

    ['Malgun Gothic', 'Malgun Gothic', 'Malgun Gothic']
    

시각화를 위해 필요한 라이브러리를 불러옵니다.


```python
import plotly.io as pio # Plotly input output
import plotly.express as px # 빠르게 그리는 방법
import plotly.graph_objects as go # 디테일한 설정
import plotly.figure_factory as ff # 템플릿 불러오기
from plotly.subplots import make_subplots # subplot 만들기
from plotly.validators.scatter.marker import SymbolValidator # Symbol 꾸미기에 사용됨
from urllib.request import urlopen
import json
import seaborn as sns
%matplotlib inline
```

📝 코로나와 관광 데이터를 합친 데이터를 불러옵니다.


```python
combined_df = pd.read_csv('covidTour_combined_final.csv', encoding='cp949', index_col=0)
```

## 📈 확진자, 사망자, 관광객 수

먼저 확진자, 사망자, 관광객 수를 따로 시각화 해보았습니다.


```python
# plt.plot(combined_df['년월'], combined_df['방문자수'])
# plt.title('월별 방문자 수')
# plt.xlabel('년월')
# plt.ylabel('방문자 수')
# plt.xticks(combined_df['년월'],  rotation='vertical')
# plt.show()
```


```python
# plt.plot(combined_df['년월'], combined_df['월별확진자수'])
# plt.title('월별 확진자 수')
# plt.xlabel('년월')
# plt.ylabel('확진자 수')
# plt.xticks(combined_df['년월'],  rotation='vertical')
# plt.show()
```


```python
# plt.plot(combined_df['년월'], combined_df['월별사망자수'])
# plt.title('월별 사망자 수')
# plt.xlabel('년월')
# plt.ylabel('사망자 수')
# plt.xticks(combined_df['년월'],  rotation='vertical')
# plt.show()
```

## 📉 확진자와 사망자 수 비례 그래프

월별 확진자 수와 사망자 수가 어떻게 비례하는지 보기 위해 데이터를 합쳐서 시각화도 해보았습니다.


```python
# y1 = ['방문자수', '월별확진자수']
# fig = px.line(combined_df, x='년월', y=y1)
# fig.update_yaxes(title_text="사람 수")
# fig.update_layout(
#     title="월별 확진자 수와 방문자 수의 값 차이가 커서 비교에 어려움이 있었습니다",
#     legend_title_text=''
# )

# fig.show()
```


```python
# fig = go.Figure()
# fig.add_trace(go.Scatter(x=combined_df['년월'], y=combined_df['방문자수'], name='방문자수', mode='lines'))
# fig.add_trace(go.Scatter(x=combined_df['년월'], y=combined_df['월별확진자수'], name='월별확진자수', mode='lines+markers'))
# fig.add_trace(go.Scatter(x=combined_df['년월'], y=combined_df['월별사망자수'], name='월별사망자수', mode='markers'))
# fig.update_layout(
#     title="월별 사망자 수도 확진자 수와 값 차이가 커서 비교에 어려움이 있었습니다",
#     xaxis_title="년월",
#     yaxis_title="사람 수"
# )
# fig.show()
```

### 💬 해결 #1: 기간을 나누어서 살펴보자

y축을 지정해서 그래프를 확대했을 때, 너무 작아서 보이지 않았던 2021년 10월까지의 데이터가 더 잘 보였다.


```python
# y2 = ['월별확진자수', '월별사망자수']
# fig = px.bar(combined_df, x='년월', y = y2, range_y = [0,65000])
# fig.update_yaxes(title_text="사람 수")
# fig.update_layout(
#     title="2019년 7월 ~ 2021년 10월 까지의 데이터를 확대하여 확인할 수 있었습니다",
#     legend_title_text=''
# )

# fig.show()
```

또한, 일부 기간에 해당하는 데이터만 가져와서 확인하였습니다. 데이터 중 관광객 수가 가장 많았던 7, 8, 9월의 관광객 수를 년도별로 비교하였습니다.


```python
data = combined_df.copy()
data.sort_values('방문자수', ascending = False)[:3]  #8월, 9월, 7월 순으로 관광객이 많은걸 확인함
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>년월</th>
      <th>월별사망자수</th>
      <th>월별확진자수</th>
      <th>방문자수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2019-08</td>
      <td>0</td>
      <td>0</td>
      <td>293357382.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-09</td>
      <td>0</td>
      <td>0</td>
      <td>271154784.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2019-07</td>
      <td>0</td>
      <td>0</td>
      <td>262952388.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 7, 8, 9월 데이터만 따로 data789 데이터프레임으로 저장함
data789 = data[data['년월'].str.contains('07') | data['년월'].str.contains('08') | data['년월'].str.contains('09')]
data789
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>년월</th>
      <th>월별사망자수</th>
      <th>월별확진자수</th>
      <th>방문자수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-07</td>
      <td>0</td>
      <td>0</td>
      <td>262952388.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-08</td>
      <td>0</td>
      <td>0</td>
      <td>293357382.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-09</td>
      <td>0</td>
      <td>0</td>
      <td>271154784.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2020-07</td>
      <td>19</td>
      <td>1486</td>
      <td>220232761.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2020-08</td>
      <td>23</td>
      <td>5845</td>
      <td>218711070.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2020-09</td>
      <td>91</td>
      <td>3707</td>
      <td>194305025.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2021-07</td>
      <td>77</td>
      <td>42055</td>
      <td>205164658.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2021-08</td>
      <td>194</td>
      <td>53663</td>
      <td>209056719.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2021-09</td>
      <td>205</td>
      <td>60328</td>
      <td>223985527.0</td>
    </tr>
  </tbody>
</table>
</div>



7, 8, 9월 관광객 수만 확인해 보았을 때 시간이 지날수록 방문자 수가 줄어든 것을 확인할 수 있었습니다.


```python
# fig = px.bar(data789, x = '년월', y = '방문자수', hover_name = '방문자수',
#              title = '7,8,9월 관광객 수만 따로 확인하였습니다')
# fig.show()
```


```python
#데이터 재정렬
data789['년'] = data789.apply((lambda x: x['년월'].split('-')[0]), axis = 1)
data789['월'] = data789.apply((lambda x: x['년월'].split('-')[1]), axis = 1)
data789
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>년월</th>
      <th>월별사망자수</th>
      <th>월별확진자수</th>
      <th>방문자수</th>
      <th>년</th>
      <th>월</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-07</td>
      <td>0</td>
      <td>0</td>
      <td>262952388.0</td>
      <td>2019</td>
      <td>07</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-08</td>
      <td>0</td>
      <td>0</td>
      <td>293357382.0</td>
      <td>2019</td>
      <td>08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-09</td>
      <td>0</td>
      <td>0</td>
      <td>271154784.0</td>
      <td>2019</td>
      <td>09</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2020-07</td>
      <td>19</td>
      <td>1486</td>
      <td>220232761.0</td>
      <td>2020</td>
      <td>07</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2020-08</td>
      <td>23</td>
      <td>5845</td>
      <td>218711070.0</td>
      <td>2020</td>
      <td>08</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2020-09</td>
      <td>91</td>
      <td>3707</td>
      <td>194305025.0</td>
      <td>2020</td>
      <td>09</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2021-07</td>
      <td>77</td>
      <td>42055</td>
      <td>205164658.0</td>
      <td>2021</td>
      <td>07</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2021-08</td>
      <td>194</td>
      <td>53663</td>
      <td>209056719.0</td>
      <td>2021</td>
      <td>08</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2021-09</td>
      <td>205</td>
      <td>60328</td>
      <td>223985527.0</td>
      <td>2021</td>
      <td>09</td>
    </tr>
  </tbody>
</table>
</div>



년도별 비교를 위해 위와 같은 7, 8, 9월 데이터를 재정렬하여 시각화 하였습니다. 좀 더 확실하게 년도별로 방문자 수가 줄어드는 것을 확인할 수 있었습니다.


```python
# fig = px.bar(data789, x = '월', y = '방문자수', color = '년', hover_name = '방문자수', barmode = 'group',
#              title = '7,8,9월 관광객 수를 년도별로 묶어 시각화 하였습니다')
# fig.show()
```

### 💬 해결 #2: 표준화를 통해서 비교해보자

👀 잘 보이지 않는 작은 값을 가진 데이터에 정수를 곱하여 그림에 더 잘 나타나도록 설정하였습니다.

 예를 들어, 사망자 수에는 50000을 곱해주고, 확진자 수에는 50을 곱해주었습니다. 데이터 간 관계를 더 자세히 확인할 수 있게 되었습니다! 😁


```python
# fig = go.Figure()
# fig.add_trace(go.Scatter(x=combined_df['년월'], y=combined_df['방문자수'], name='방문자수', mode='lines'))
# fig.add_trace(go.Scatter(x=combined_df['년월'], y=combined_df['월별확진자수']*50, name='월별확진자수', mode='lines+markers'))
# fig.add_trace(go.Scatter(x=combined_df['년월'], y=combined_df['월별사망자수']*50000, name='월별사망자수', mode='markers'))
# fig.show()
```

데이터의 값 크기가 달라 그래프가 이상치를 포함한 결과로 그려지고 그래프의 해석이 어려워지기 때문에 단위를 통일해주고자 이상치에 덜 민감한 **RobustScale** 방법을 이용하여 표준화 시켰습니다.


```python
from sklearn.preprocessing import RobustScaler

#표준화 데이터 생성
data_scale = data.copy()

#표준화 진행
data_scale['방문자수_scale'] = RobustScaler().fit_transform(data[['방문자수']])
data_scale['월별확진자수_scale'] = RobustScaler().fit_transform(data[['월별확진자수']])
data_scale['월별사망자수_scale'] = RobustScaler().fit_transform(data[['월별사망자수']])

data_scale.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>년월</th>
      <th>월별사망자수</th>
      <th>월별확진자수</th>
      <th>방문자수</th>
      <th>방문자수_scale</th>
      <th>월별확진자수_scale</th>
      <th>월별사망자수_scale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-07</td>
      <td>0</td>
      <td>0</td>
      <td>262952388.0</td>
      <td>2.015866</td>
      <td>-0.232248</td>
      <td>-0.267143</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-08</td>
      <td>0</td>
      <td>0</td>
      <td>293357382.0</td>
      <td>3.212243</td>
      <td>-0.232248</td>
      <td>-0.267143</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-09</td>
      <td>0</td>
      <td>0</td>
      <td>271154784.0</td>
      <td>2.338614</td>
      <td>-0.232248</td>
      <td>-0.267143</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-10</td>
      <td>0</td>
      <td>0</td>
      <td>254882209.0</td>
      <td>1.698321</td>
      <td>-0.232248</td>
      <td>-0.267143</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-11</td>
      <td>0</td>
      <td>0</td>
      <td>254841999.0</td>
      <td>1.696738</td>
      <td>-0.232248</td>
      <td>-0.267143</td>
    </tr>
  </tbody>
</table>
</div>




```python
# fig = go.Figure()
# fig.add_trace(go.Scatter(x=data_scale['년월'], y=data_scale['월별확진자수_scale'], name='월별확진자수', mode='lines+markers'))
# fig.add_trace(go.Scatter(x=data_scale['년월'], y=data_scale['방문자수_scale'], name='방문자수', mode='lines+markers'))
# fig.update_layout(
#     title="스케일링 후 코로나 확진자 수와 관광객 수의 시계열 그래프를 그려보았습니다",
#     xaxis_title="년월",
#     yaxis_title="사람 수"
# )
```

하지만 RobustScale을 이용해도 이상치가 너무 크게 나타나서 여전히 그래프 해석에 어려움이 존재하기 때문에 확진자수가 급감하기 이전인 **2021년 10월까지의 데이터**로 다시 표준화를 진행하였습니다.

이번에는 표준화 방법 중 가장 일반적인 **StandardScale**을 이용하였습니다.


```python
from sklearn.preprocessing import StandardScaler

#표준화 데이터 생성
data_scale2 = data[:28]

#표준화 진행
data_scale2['방문자수_scale'] = StandardScaler().fit_transform(data_scale2[['방문자수']])
data_scale2['월별확진자수_scale'] = StandardScaler().fit_transform(data_scale2[['월별확진자수']])
data_scale2['월별사망자수_scale'] = StandardScaler().fit_transform(data_scale2[['월별사망자수']])

data_scale2.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>년월</th>
      <th>월별사망자수</th>
      <th>월별확진자수</th>
      <th>방문자수</th>
      <th>방문자수_scale</th>
      <th>월별확진자수_scale</th>
      <th>월별사망자수_scale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-07</td>
      <td>0</td>
      <td>0</td>
      <td>262952388.0</td>
      <td>1.513755</td>
      <td>-0.740185</td>
      <td>-0.796746</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-08</td>
      <td>0</td>
      <td>0</td>
      <td>293357382.0</td>
      <td>2.488978</td>
      <td>-0.740185</td>
      <td>-0.796746</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-09</td>
      <td>0</td>
      <td>0</td>
      <td>271154784.0</td>
      <td>1.776842</td>
      <td>-0.740185</td>
      <td>-0.796746</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-10</td>
      <td>0</td>
      <td>0</td>
      <td>254882209.0</td>
      <td>1.254909</td>
      <td>-0.740185</td>
      <td>-0.796746</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-11</td>
      <td>0</td>
      <td>0</td>
      <td>254841999.0</td>
      <td>1.253619</td>
      <td>-0.740185</td>
      <td>-0.796746</td>
    </tr>
  </tbody>
</table>
</div>




```python
# fig = go.Figure()

# fig.add_trace(go.Scatter(x=data_scale2['년월'], y=data_scale2['월별확진자수_scale'], name='월별확진자수', mode='lines+markers'))
# fig.add_trace(go.Scatter(x=data_scale2['년월'], y=data_scale2['방문자수_scale'], name='방문자수', mode='lines+markers'))
# fig.update_layout(
#     title="스케일링 후 2021년까지의 코로나 <b>확진자 수와 관광객 수</b>의 시계열 그래프를 그려보았습니다",
#     xaxis_title="년월",
#     yaxis_title="사람 수"
# )
```


```python
# fig = go.Figure()

# fig.add_trace(go.Scatter(x=data_scale2['년월'], y=data_scale2['월별사망자수_scale'], name='월별사망자수', mode='lines+markers'))
# fig.add_trace(go.Scatter(x=data_scale2['년월'], y=data_scale2['방문자수_scale'], name='방문자수', mode='lines+markers'))
# fig.update_layout(
#     title="스케일링 후 2021년까지의 코로나 <b>사망자 수와 관광객 수</b>의 시계열 그래프를 그려보았습니다",
#     xaxis_title="년월",
#     yaxis_title="사람 수"
# )
```


### 💬 해결 #3: 로그변환을 통해서 비교해보자

y축의 확진자 수와 사망자 수를 로그변환하여 데이터 값을 더 직관적으로 비교할 수 있었습니다.


```python
# fig = make_subplots(specs=[[{"secondary_y": True}]])

# fig.add_trace(go.Bar(x=combined_df["년월"], y=combined_df["월별확진자수"], name="월별확진자수", opacity=0.7), secondary_y=False)
# fig.add_trace(go.Scatter(x=combined_df["년월"], y=combined_df["월별사망자수"], name="월별사망자수", line=dict(width=4)), secondary_y=True)

# fig.update_layout(
#     title="로그변환을 통해 월별 확진자 수와 사망자 수가 비례하는걸 확인할 수 있습니다", xaxis_title="년월"
# )
# fig.update_yaxes(title_text="확진자 수", secondary_y=False, type='log')
# fig.update_yaxes(title_text="사망자 수", secondary_y=True, type='log')

# fig.show()
```

*   코로나 이전에 비해 전체 방문자 수가 코로나 이후에 낮아졌습니다.

*   특히, 관광객 수가 가장 많았던 2019년도 여름에 비해 2020년과 2021년 여름에는 관광객이 많이 줄었음을 확인할 수 있습니다.

*   코로나 확진자 수와 관광객 수는 대체적으로 반비례 하였습니다.



# 🐳 결론


```python
# fig = make_subplots(specs=[[{"secondary_y": True}]])

# fig.add_trace(go.Bar(x=combined_df["년월"], y=combined_df["월별확진자수"], name="월별확진자수", opacity=0.7), secondary_y=False)
# fig.add_trace(go.Scatter(x=combined_df["년월"], y=combined_df["방문자수"], name="방문자수", line=dict(width=4)), secondary_y=True)

# fig.add_hline(y=13000, line_dash="dot",
#               annotation_text="코로나 이전만큼 방문자 수가 많지 않다",
#               annotation_position="bottom left")
# fig.add_vrect(x0="2020-01", x1="2020-03", col=1,
#               annotation_text="<b>코로나 시작", annotation_position="top left",
#               fillcolor="green", opacity=0.2, line_width=0)

# fig.update_layout(
#     title="코로나 시작 이후 관광 방문자 수가 줄어들었다", xaxis_title="년월"
# )
# fig.update_yaxes(title_text="확진자 수", secondary_y=False, type="log")
# fig.update_yaxes(title_text="방문자 수", secondary_y=True)

# fig.show()
```


```python

```
